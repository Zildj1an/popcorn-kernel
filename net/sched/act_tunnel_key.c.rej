--- net/sched/act_tunnel_key.c
+++ net/sched/act_tunnel_key.c
@@ -219,9 +219,9 @@ static int tunnel_key_init(struct net *net, struct nlattr *nla,
 	struct tcf_tunnel_key *t;
 	bool exists = false;
 	__be16 dst_port = 0;
-	__be64 key_id = 0;
 	int opts_len = 0;
-	__be16 flags = 0;
+	__be64 key_id;
+	__be16 flags;
 	u8 tos, ttl;
 	int ret = 0;
 	int err;
@@ -255,15 +255,15 @@ static int tunnel_key_init(struct net *net, struct nlattr *nla,
 	case TCA_TUNNEL_KEY_ACT_RELEASE:
 		break;
 	case TCA_TUNNEL_KEY_ACT_SET:
-		if (tb[TCA_TUNNEL_KEY_ENC_KEY_ID]) {
-			__be32 key32;
+		if (!tb[TCA_TUNNEL_KEY_ENC_KEY_ID]) {
+			NL_SET_ERR_MSG(extack, "Missing tunnel key id");
+			ret = -EINVAL;
+			goto err_out;
+		}
 
-			key32 = nla_get_be32(tb[TCA_TUNNEL_KEY_ENC_KEY_ID]);
-			key_id = key32_to_tunnel_id(key32);
-			flags = TUNNEL_KEY;
-		}
+		key_id = key32_to_tunnel_id(nla_get_be32(tb[TCA_TUNNEL_KEY_ENC_KEY_ID]));
 
-		flags |= TUNNEL_CSUM;
+		flags = TUNNEL_KEY | TUNNEL_CSUM;
 		if (tb[TCA_TUNNEL_KEY_NO_CSUM] &&
 		    nla_get_u8(tb[TCA_TUNNEL_KEY_NO_CSUM]))
 			flags &= ~TUNNEL_CSUM;
@@ -512,13 +512,10 @@ static int tunnel_key_dump(struct sk_buff *skb, struct tc_action *a,
 		struct ip_tunnel_key *key = &info->key;
 		__be32 key_id = tunnel_id_to_key32(key->tun_id);
 
-		if (((key->tun_flags & TUNNEL_KEY) &&
-		     nla_put_be32(skb, TCA_TUNNEL_KEY_ENC_KEY_ID, key_id)) ||
+		if (nla_put_be32(skb, TCA_TUNNEL_KEY_ENC_KEY_ID, key_id) ||
 		    tunnel_key_dump_addresses(skb,
 					      &params->tcft_enc_metadata->u.tun_info) ||
-		    (key->tp_dst &&
-		      nla_put_be16(skb, TCA_TUNNEL_KEY_ENC_DST_PORT,
-				   key->tp_dst)) ||
+		    nla_put_be16(skb, TCA_TUNNEL_KEY_ENC_DST_PORT, key->tp_dst) ||
 		    nla_put_u8(skb, TCA_TUNNEL_KEY_NO_CSUM,
 			       !(key->tun_flags & TUNNEL_CSUM)) ||
 		    tunnel_key_opts_dump(skb, info))
